<!doctype html>

<html lang="en">
<head>
    <script src="https://broadwayinc.dev/jslib/wysiwyg4all/0.1.0/wysiwyg4all.js"></script>
    <!--<script src="wysiwyg4all.js"></script>
    <script src="https://broadwayinc.dev/jslib/colormangle/0.1.0/colormangle.js"></script>-->
    <link rel="stylesheet" type="text/css" href="https://broadwayinc.dev/jslib/wysiwyg4all/0.1.0/wysiwyg4all.css" />
</head>

<body>
<h1>Wysiwyg4All</h1>
<hr>
<div id="sample" style="width: 512px; margin:1rem auto; padding:1rem; border: solid 1px teal"></div>
<div style="width: 512px; margin:1rem auto;">
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('h4')">
        H4
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('bold')">
        BOLD
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('color')">
        COLOR
    </button>
    <button onclick="input_color_string()">
        CUSTOM COLOR
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('strike')">
        STRIKE
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('underline')">
        UNDERLINE
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('divider')">
        DIVIDER
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('quote')">
        QUOTE
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('unorderedList')">
        UNORDERED LIST
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('orderedList')">
        ORDERED LIST
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('image')">
        PHOTO
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('alignLeft')">
        ALIGN LEFT
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('alignCenter')">
        ALIGN CENTER
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="wysiwyg.command('alignRight')">
        ALIGN RIGHT
    </button>
    <button onmousedown="(function(event){event.preventDefault()})(event)" onclick="export_data()">
        EXPORT
    </button>
</div>

</body>
<script>

    let wysiwyg = new Wysiwyg4All({
        elementId: 'sample',
        hashtag: true,
        placeholder: 'HELLO',
        spellcheck: true,
        urllink: true,
        logMutation: false,
        lastLineBlank: true,
        callback: async c => {
            if (c.image) {
                let img = c.image;
                if (Array.isArray(img))
                    for (let h of img) {
                        h.onclick = (e) => {
                            console.log({e});
                        };
                        h.class = ['sample'];
                        h.style = {};
                        h.style.width = '50%';
                        h.style.margin = 'auto';
                        // let custom = document.createElement('div');
                        // custom.append(document.createTextNode('SAMPLE'));
                        // custom.style.backgroundColor = 'teal';
                        // custom.style.color = 'white';
                        // h.element = custom;
                    }
            }
            if (c.hashtag) {
                let ht = c.hashtag;
                if (Array.isArray(ht))
                    for (let h of ht) {
                        h.onclick = (e) => {
                            console.log({e});
                        };
                        h.class = ['sample'];
                        // let custom = document.createElement('div');
                        // custom.append(document.createTextNode('SAMPLE'));
                        // custom.style.backgroundColor = 'teal';
                        // custom.style.color = 'white';
                        // h.element = custom;
                        // h.custom = true;
                    }
            }
            if (c.urllink) {
                let ht = c.urllink;
                if (Array.isArray(ht))
                    for (let h of ht) {
                        h.onclick = (e) => {
                            console.log({e});
                        };
                        h.class = ['sample'];

                        if (c.urllink) {
                            // for (let u of c.urllink) {
                            //     console.log({u});
                            //     let div = document.createElement('div');
                            //     let frame = document.createElement('iframe');
                            //
                            //     frame.setAttribute('scrolling', 'no');
                            //     frame.setAttribute('frameborder', '0');
                            //     frame.setAttribute('allow', 'accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture');
                            //     frame.setAttribute('allowfullscreen', '');
                            //
                            //     div.classList.add(`youtube-embed-container`);
                            //     frame.src = u.url;
                            //     div.append(frame);
                            //     u.element = div;
                            //     u.custom = true;
                            // }
                        }

                        // let custom = document.createElement('div');
                        // custom.append(document.createTextNode('SAMPLE'));
                        // custom.style.backgroundColor = 'teal';
                        // custom.style.color = 'white';
                        // h.element = custom;
                        // h.custom = true;
                    }
            }
            if (c.caratPosition) {
                let viewPortHeight = Math.min(document.documentElement.clientHeight || 0, window.innerHeight || 0);
                let minusWhenOutOfView = viewPortHeight - c.caratPosition.top;
                if (minusWhenOutOfView < 0)
                    window.scrollBy(0, -minusWhenOutOfView);
            }
            // console.log(c);
            return c;
        }
    });
    let export_data = () => {
        wysiwyg.export(pre => {
            console.log(pre);
        }).then(e => {
            console.log(e);
        });
    };
    let input_color_string = () => {
        let color = prompt("Input Color String");
        wysiwyg.restoreLastSelection();
        wysiwyg.command(color);
    }
</script>
</html>
